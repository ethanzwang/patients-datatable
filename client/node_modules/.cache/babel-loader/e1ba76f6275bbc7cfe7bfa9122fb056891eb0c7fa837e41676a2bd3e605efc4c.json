{"ast":null,"code":"import $ from 'jquery';\nimport * as XLSX from 'xlsx';\nexport const handleExcelUpload = table => {\n  const input = $('<input type=\"file\" accept=\".xlsx, .xls\">');\n  $('body').append(input);\n  input.on('change', event => {\n    const file = event.target.files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = e => {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, {\n        type: 'array'\n      });\n      const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n      const jsonData = XLSX.utils.sheet_to_json(worksheet);\n      const tableData = table.rows().data().toArray();\n      const subjectMap = tableData.reduce((map, row) => {\n        map[row.Subject] = row;\n        return map;\n      }, {});\n      jsonData.forEach(row => {\n        if (subjectMap[row.Subject]) {\n          const rowIndex = table.row(subjectMap[row.Subject]).index();\n          table.row(rowIndex).data(row).draw();\n        }\n      });\n      input.remove();\n    };\n    reader.readAsArrayBuffer(file);\n  });\n};","map":{"version":3,"names":["$","XLSX","handleExcelUpload","table","input","append","on","event","file","target","files","reader","FileReader","onload","e","data","Uint8Array","result","workbook","read","type","worksheet","Sheets","SheetNames","jsonData","utils","sheet_to_json","tableData","rows","toArray","subjectMap","reduce","map","row","Subject","forEach","rowIndex","index","draw","remove","readAsArrayBuffer"],"sources":["/Users/ethanzwang/Desktop/patients-datatable/client/src/components/uploadExcel.js"],"sourcesContent":["import $ from 'jquery';\nimport * as XLSX from 'xlsx';\n\nexport const handleExcelUpload = (table) => {\n    const input = $('<input type=\"file\" accept=\".xlsx, .xls\">');\n\n    $('body').append(input);\n\n    input.on('change', (event) => {\n        const file = event.target.files[0];\n        if (!file) return;\n\n        const reader = new FileReader();\n        reader.onload = (e) => {\n            const data = new Uint8Array(e.target.result);\n            const workbook = XLSX.read(data, { type: 'array' });\n      \n            const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n            const jsonData = XLSX.utils.sheet_to_json(worksheet);\n\n            const tableData = table.rows().data().toArray();\n            const subjectMap = tableData.reduce((map, row) => {\n                map[row.Subject] = row;\n                return map;\n            }, {});\n\n            jsonData.forEach((row) => {\n                if (subjectMap[row.Subject]) {\n\n                    const rowIndex = table.row(subjectMap[row.Subject]).index();\n                    table.row(rowIndex).data(row).draw();\n                }\n            });\n\n            input.remove();\n        };\n\n        reader.readAsArrayBuffer(file);\n    });\n\n};"],"mappings":"AAAA,OAAOA,CAAC,MAAM,QAAQ;AACtB,OAAO,KAAKC,IAAI,MAAM,MAAM;AAE5B,OAAO,MAAMC,iBAAiB,GAAIC,KAAK,IAAK;EACxC,MAAMC,KAAK,GAAGJ,CAAC,CAAC,0CAA0C,CAAC;EAE3DA,CAAC,CAAC,MAAM,CAAC,CAACK,MAAM,CAACD,KAAK,CAAC;EAEvBA,KAAK,CAACE,EAAE,CAAC,QAAQ,EAAGC,KAAK,IAAK;IAC1B,MAAMC,IAAI,GAAGD,KAAK,CAACE,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC;IAClC,IAAI,CAACF,IAAI,EAAE;IAEX,MAAMG,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,MAAM,GAAIC,CAAC,IAAK;MACnB,MAAMC,IAAI,GAAG,IAAIC,UAAU,CAACF,CAAC,CAACL,MAAM,CAACQ,MAAM,CAAC;MAC5C,MAAMC,QAAQ,GAAGjB,IAAI,CAACkB,IAAI,CAACJ,IAAI,EAAE;QAAEK,IAAI,EAAE;MAAQ,CAAC,CAAC;MAEnD,MAAMC,SAAS,GAAGH,QAAQ,CAACI,MAAM,CAACJ,QAAQ,CAACK,UAAU,CAAC,CAAC,CAAC,CAAC;MACzD,MAAMC,QAAQ,GAAGvB,IAAI,CAACwB,KAAK,CAACC,aAAa,CAACL,SAAS,CAAC;MAEpD,MAAMM,SAAS,GAAGxB,KAAK,CAACyB,IAAI,CAAC,CAAC,CAACb,IAAI,CAAC,CAAC,CAACc,OAAO,CAAC,CAAC;MAC/C,MAAMC,UAAU,GAAGH,SAAS,CAACI,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;QAC9CD,GAAG,CAACC,GAAG,CAACC,OAAO,CAAC,GAAGD,GAAG;QACtB,OAAOD,GAAG;MACd,CAAC,EAAE,CAAC,CAAC,CAAC;MAENR,QAAQ,CAACW,OAAO,CAAEF,GAAG,IAAK;QACtB,IAAIH,UAAU,CAACG,GAAG,CAACC,OAAO,CAAC,EAAE;UAEzB,MAAME,QAAQ,GAAGjC,KAAK,CAAC8B,GAAG,CAACH,UAAU,CAACG,GAAG,CAACC,OAAO,CAAC,CAAC,CAACG,KAAK,CAAC,CAAC;UAC3DlC,KAAK,CAAC8B,GAAG,CAACG,QAAQ,CAAC,CAACrB,IAAI,CAACkB,GAAG,CAAC,CAACK,IAAI,CAAC,CAAC;QACxC;MACJ,CAAC,CAAC;MAEFlC,KAAK,CAACmC,MAAM,CAAC,CAAC;IAClB,CAAC;IAED5B,MAAM,CAAC6B,iBAAiB,CAAChC,IAAI,CAAC;EAClC,CAAC,CAAC;AAEN,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}