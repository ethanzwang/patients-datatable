{"ast":null,"code":"import $ from 'jquery';\nimport * as XLSX from 'xlsx';\nexport const handleExcelUpload = table => {\n  let input = $('#uploadExcelInput');\n  if (input.length === 0) {\n    input = $('<input type=\"file\" id=\"uploadExcelInput\" accept=\".xlsx, .xls\" style=\"display: none;\">');\n    $('body').append(input);\n  }\n  input.on('change', function () {\n    const file = this.files[0];\n    if (!file) return;\n    const reader = new FileReader();\n    reader.onload = function (e) {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, {\n        type: 'array'\n      });\n      const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n      const jsonData = XLSX.utils.sheet_to_json(worksheet);\n      const tableData = table.rows().data().toArray();\n      const subjectMap = tableData.reduce((map, row) => {\n        map[row.Subject] = row;\n        return map;\n      }, {});\n      jsonData.forEach(row => {\n        if (subjectMap[row.Subject]) {\n          const rowIndex = table.rows().indexes().toArray().find(index => table.row(index).data().Subject === row.Subject);\n          if (rowIndex !== undefined) {\n            table.row(rowIndex).data(row).draw();\n          }\n        }\n      });\n      input.val('');\n    };\n    reader.readAsArrayBuffer(file);\n  });\n  input.click();\n};","map":{"version":3,"names":["$","XLSX","handleExcelUpload","table","input","length","append","on","file","files","reader","FileReader","onload","e","data","Uint8Array","target","result","workbook","read","type","worksheet","Sheets","SheetNames","jsonData","utils","sheet_to_json","tableData","rows","toArray","subjectMap","reduce","map","row","Subject","forEach","rowIndex","indexes","find","index","undefined","draw","val","readAsArrayBuffer","click"],"sources":["/Users/ethanzwang/Desktop/patients-datatable/client/src/components/uploadExcel.js"],"sourcesContent":["import $ from 'jquery';\nimport * as XLSX from 'xlsx';\n\nexport const handleExcelUpload = (table) => {    \n    let input = $('#uploadExcelInput');\n  \n  if (input.length === 0) {\n\n    input = $('<input type=\"file\" id=\"uploadExcelInput\" accept=\".xlsx, .xls\" style=\"display: none;\">');\n    $('body').append(input);\n  }\n\n\n  input.on('change', function () {\n    const file = this.files[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = function (e) {\n      const data = new Uint8Array(e.target.result);\n      const workbook = XLSX.read(data, { type: 'array' });\n      \n\n      const worksheet = workbook.Sheets[workbook.SheetNames[0]];\n      const jsonData = XLSX.utils.sheet_to_json(worksheet);\n\n      const tableData = table.rows().data().toArray();\n      const subjectMap = tableData.reduce((map, row) => {\n        map[row.Subject] = row;\n        return map;\n      }, {});\n\n      jsonData.forEach((row) => {\n        if (subjectMap[row.Subject]) {\n\n          const rowIndex = table.rows().indexes().toArray().find(index => table.row(index).data().Subject === row.Subject);\n          if (rowIndex !== undefined) {\n            table.row(rowIndex).data(row).draw();\n          }\n        }\n      });\n\n      input.val('');\n    };\n\n    reader.readAsArrayBuffer(file);\n  });\n\n  input.click();\n};"],"mappings":"AAAA,OAAOA,CAAC,MAAM,QAAQ;AACtB,OAAO,KAAKC,IAAI,MAAM,MAAM;AAE5B,OAAO,MAAMC,iBAAiB,GAAIC,KAAK,IAAK;EACxC,IAAIC,KAAK,GAAGJ,CAAC,CAAC,mBAAmB,CAAC;EAEpC,IAAII,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;IAEtBD,KAAK,GAAGJ,CAAC,CAAC,uFAAuF,CAAC;IAClGA,CAAC,CAAC,MAAM,CAAC,CAACM,MAAM,CAACF,KAAK,CAAC;EACzB;EAGAA,KAAK,CAACG,EAAE,CAAC,QAAQ,EAAE,YAAY;IAC7B,MAAMC,IAAI,GAAG,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC;IAC1B,IAAI,CAACD,IAAI,EAAE;IAEX,MAAME,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;IAC/BD,MAAM,CAACE,MAAM,GAAG,UAAUC,CAAC,EAAE;MAC3B,MAAMC,IAAI,GAAG,IAAIC,UAAU,CAACF,CAAC,CAACG,MAAM,CAACC,MAAM,CAAC;MAC5C,MAAMC,QAAQ,GAAGjB,IAAI,CAACkB,IAAI,CAACL,IAAI,EAAE;QAAEM,IAAI,EAAE;MAAQ,CAAC,CAAC;MAGnD,MAAMC,SAAS,GAAGH,QAAQ,CAACI,MAAM,CAACJ,QAAQ,CAACK,UAAU,CAAC,CAAC,CAAC,CAAC;MACzD,MAAMC,QAAQ,GAAGvB,IAAI,CAACwB,KAAK,CAACC,aAAa,CAACL,SAAS,CAAC;MAEpD,MAAMM,SAAS,GAAGxB,KAAK,CAACyB,IAAI,CAAC,CAAC,CAACd,IAAI,CAAC,CAAC,CAACe,OAAO,CAAC,CAAC;MAC/C,MAAMC,UAAU,GAAGH,SAAS,CAACI,MAAM,CAAC,CAACC,GAAG,EAAEC,GAAG,KAAK;QAChDD,GAAG,CAACC,GAAG,CAACC,OAAO,CAAC,GAAGD,GAAG;QACtB,OAAOD,GAAG;MACZ,CAAC,EAAE,CAAC,CAAC,CAAC;MAENR,QAAQ,CAACW,OAAO,CAAEF,GAAG,IAAK;QACxB,IAAIH,UAAU,CAACG,GAAG,CAACC,OAAO,CAAC,EAAE;UAE3B,MAAME,QAAQ,GAAGjC,KAAK,CAACyB,IAAI,CAAC,CAAC,CAACS,OAAO,CAAC,CAAC,CAACR,OAAO,CAAC,CAAC,CAACS,IAAI,CAACC,KAAK,IAAIpC,KAAK,CAAC8B,GAAG,CAACM,KAAK,CAAC,CAACzB,IAAI,CAAC,CAAC,CAACoB,OAAO,KAAKD,GAAG,CAACC,OAAO,CAAC;UAChH,IAAIE,QAAQ,KAAKI,SAAS,EAAE;YAC1BrC,KAAK,CAAC8B,GAAG,CAACG,QAAQ,CAAC,CAACtB,IAAI,CAACmB,GAAG,CAAC,CAACQ,IAAI,CAAC,CAAC;UACtC;QACF;MACF,CAAC,CAAC;MAEFrC,KAAK,CAACsC,GAAG,CAAC,EAAE,CAAC;IACf,CAAC;IAEDhC,MAAM,CAACiC,iBAAiB,CAACnC,IAAI,CAAC;EAChC,CAAC,CAAC;EAEFJ,KAAK,CAACwC,KAAK,CAAC,CAAC;AACf,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}