{"ast":null,"code":"import $ from 'jquery';\nimport * as XLSX from 'xlsx';\nexport const handleExcelUpload = table => {\n  let fileInput = $('#uploadExcel');\n  if (fileInput.length === 0) {\n    fileInput = $('<input type=\"file\" id=\"uploadExcel\" accept=\".xlsx, .xls\" />');\n    $('.container').append(fileInput);\n  }\n  fileInput.on('change', function (e) {\n    const file = e.target.files[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onload = function (event) {\n        const data = new Uint8Array(event.target.result);\n        const workbook = XLSX.read(data, {\n          type: 'array'\n        });\n        const firstSheetName = workbook.SheetNames[0];\n        const worksheet = XLSX.utils.sheet_to_json(workbook.Sheets[firstSheetName]);\n        worksheet.forEach(excelRow => {\n          const subject = excelRow['Subject'];\n          table.rows().every(function () {\n            const rowData = this.data();\n            const rowSubject = rowData[0];\n            if (rowSubject === subject) {\n              const updatedData = [excelRow['Subject'] || rowData[0], excelRow['Age'] || rowData[1], excelRow['Sex'] || rowData[2], excelRow['OnsetAge'] || rowData[3], excelRow['Handedness'] || rowData[4], excelRow['DomHemi'] || rowData[5], excelRow['Wada'] || rowData[6], excelRow['fMRI'] || rowData[7], excelRow['CSM'] || rowData[8], excelRow['SurgHemi'] || rowData[9], excelRow['SurgType'] || rowData[10], excelRow['SurgDescription'] || rowData[11], excelRow['SurgDate'] || rowData[12], excelRow['ILAE'] || rowData[13], excelRow['Engel'] || rowData[14], excelRow['MRI'] || rowData[15], excelRow['SurgHx'] || rowData[16], excelRow['SurgHxHemi'] || rowData[17], excelRow['SurgHxType'] || rowData[18], excelRow['SurgHxDate'] || rowData[19], excelRow['PreNP_DOE'] || rowData[20], excelRow['PostNP_DOE'] || rowData[21], excelRow['FSIQ'] || rowData[22], excelRow['English'] || rowData[23], excelRow['ECoG_Hemi'] || rowData[24], excelRow['ECoG'] || rowData[25], excelRow['ImplantDate'] || rowData[26], excelRow['AwakeCSM'] || rowData[27], excelRow['AwakeCSM_Tasks'] || rowData[28], excelRow['AsleepCSM'] || rowData[29], excelRow['AsleepCSM_Tasks'] || rowData[30], excelRow['Prime'] || rowData[31], excelRow['ThalamusStim'] || rowData[32], excelRow['Meg'] || rowData[33], excelRow['Rearranged'] || rowData[34], excelRow['Reimplant'] || rowData[35], excelRow['Reop'] || rowData[36]];\n              this.data(updatedData);\n            }\n          });\n        });\n        table.draw(false);\n      };\n      reader.readAsArrayBuffer(file);\n    }\n  });\n};","map":{"version":3,"names":["$","XLSX","handleExcelUpload","table","fileInput","length","append","on","e","file","target","files","reader","FileReader","onload","event","data","Uint8Array","result","workbook","read","type","firstSheetName","SheetNames","worksheet","utils","sheet_to_json","Sheets","forEach","excelRow","subject","rows","every","rowData","rowSubject","updatedData","draw","readAsArrayBuffer"],"sources":["/Users/ethanwang/patients-datatable/client/src/components/uploadExcel.js"],"sourcesContent":["import $ from 'jquery';\nimport * as XLSX from 'xlsx';\n\nexport const handleExcelUpload = (table) => {\n    let fileInput = $('#uploadExcel');\n\n    if (fileInput.length === 0) {\n        fileInput = $('<input type=\"file\" id=\"uploadExcel\" accept=\".xlsx, .xls\" />');\n        $('.container').append(fileInput);\n    }\n\n    fileInput.on('change', function (e) {\n        const file = e.target.files[0];\n\n        if (file) {\n            const reader = new FileReader();\n\n            reader.onload = function (event) {\n                const data = new Uint8Array(event.target.result);\n                const workbook = XLSX.read(data, { type: 'array' });\n                const firstSheetName = workbook.SheetNames[0];\n                const worksheet = XLSX.utils.sheet_to_json(workbook.Sheets[firstSheetName]);\n\n                worksheet.forEach((excelRow) => {\n                    const subject = excelRow['Subject'];\n\n                    table.rows().every(function () {\n                        const rowData = this.data();\n                        const rowSubject = rowData[0];\n\n                        if (rowSubject === subject) {\n                            const updatedData = [\n                                excelRow['Subject'] || rowData[0],\n                                excelRow['Age'] || rowData[1],\n                                excelRow['Sex'] || rowData[2],\n                                excelRow['OnsetAge'] || rowData[3],\n                                excelRow['Handedness'] || rowData[4],\n                                excelRow['DomHemi'] || rowData[5],\n                                excelRow['Wada'] || rowData[6],\n                                excelRow['fMRI'] || rowData[7],\n                                excelRow['CSM'] || rowData[8],\n                                excelRow['SurgHemi'] || rowData[9],\n                                excelRow['SurgType'] || rowData[10],\n                                excelRow['SurgDescription'] || rowData[11],\n                                excelRow['SurgDate'] || rowData[12],\n                                excelRow['ILAE'] || rowData[13],\n                                excelRow['Engel'] || rowData[14],\n                                excelRow['MRI'] || rowData[15],\n                                excelRow['SurgHx'] || rowData[16],\n                                excelRow['SurgHxHemi'] || rowData[17],\n                                excelRow['SurgHxType'] || rowData[18],\n                                excelRow['SurgHxDate'] || rowData[19],\n                                excelRow['PreNP_DOE'] || rowData[20],\n                                excelRow['PostNP_DOE'] || rowData[21],\n                                excelRow['FSIQ'] || rowData[22],\n                                excelRow['English'] || rowData[23],\n                                excelRow['ECoG_Hemi'] || rowData[24],\n                                excelRow['ECoG'] || rowData[25],\n                                excelRow['ImplantDate'] || rowData[26],\n                                excelRow['AwakeCSM'] || rowData[27],\n                                excelRow['AwakeCSM_Tasks'] || rowData[28],\n                                excelRow['AsleepCSM'] || rowData[29],\n                                excelRow['AsleepCSM_Tasks'] || rowData[30],\n                                excelRow['Prime'] || rowData[31],\n                                excelRow['ThalamusStim'] || rowData[32],\n                                excelRow['Meg'] || rowData[33],\n                                excelRow['Rearranged'] || rowData[34],\n                                excelRow['Reimplant'] || rowData[35],\n                                excelRow['Reop'] || rowData[36],\n                                \n                            ];\n                            this.data(updatedData);\n                        }\n                    });\n                });\n\n                table.draw(false);\n            };\n\n            reader.readAsArrayBuffer(file);\n        }\n    });\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}